"use strict";

let moment = require("moment");
let getPeriods = require("../index.js");

describe("get periods", function () {
    it("should return expected periods with no granularity restrictions", function (done) {
        let dateFrom = "2017-05-21";
        let dateTo = "2019-06-13";

        let expectedData = {
            day: [
                '2017-05-21',
                    '2017-05-22',
                    '2017-05-23',
                    '2017-05-24',
                    '2017-05-25',
                    '2017-05-26',
                    '2017-05-27',
                    '2017-05-28',
                    '2017-05-29',
                    '2017-05-30',
                    '2017-05-31',
                    '2019-06-01',
                    '2019-06-02',
                    '2019-06-03',
                    '2019-06-04',
                    '2019-06-05',
                    '2019-06-06',
                    '2019-06-07',
                    '2019-06-08',
                    '2019-06-09',
                    '2019-06-10',
                    '2019-06-11',
                    '2019-06-12',
                    '2019-06-13'
                ],
            month: [ '2017-06', '2019-04', '2019-05' ],
            quarter: [ '2017-3rd', '2017-4th', '2019-1st' ],
            year: [ '2018' ]
        };

        getPeriods(dateFrom, dateTo).should.be.eql(expectedData);
        done();
    });
    it("should return expected periods with restricted granularity = quarter and formatted day", function (done) {
        let dateFrom = "2017-05-21";
        let dateTo = moment("2019-06-13");

        let expectedData = {
            day: [
                '21/05/17',
                '22/05/17',
                '23/05/17',
                '24/05/17',
                '25/05/17',
                '26/05/17',
                '27/05/17',
                '28/05/17',
                '29/05/17',
                '30/05/17',
                '31/05/17',
                '01/06/19',
                '02/06/19',
                '03/06/19',
                '04/06/19',
                '05/06/19',
                '06/06/19',
                '07/06/19',
                '08/06/19',
                '09/06/19',
                '10/06/19',
                '11/06/19',
                '12/06/19',
                '13/06/19'
            ],
            month: [ '2017-06', '2019-04', '2019-05' ],
            quarter: [
                '2017-3rd',
                    '2017-4th',
                    '2018-1st',
                    '2018-2nd',
                    '2018-3rd',
                    '2018-4th',
                    '2019-1st'
                ]
        };

        getPeriods(dateFrom, dateTo, {restrictedGranularity: {year: true}, formats: { day: "DD/MM/YY" }}).should.be.eql(expectedData);
        done();
    });

    it("should return expected range of years excluding all others", function (done) {
        let dateFrom = "2003-01-01";
        let dateTo = moment("2019-05-07");

        let expectedData = {
            year: ["2003", "2004", "2005", "2006", "2007", "2008", "2009", "2010", "2011", "2012", "2013", "2014", "2015", "2016", "2017", "2018", "2019"]
        };

        getPeriods(dateFrom, dateTo, {restrictedGranularity: {month: true, day: true, quarter: true}}).should.be.eql(expectedData);
        done();
    });

    it("should return expected periods with restricted quarter and month. Also with formatted day", function (done) {
        let dateFrom = "2017-05-21";
        let dateTo = moment("2019-06-13");

        let expectedData = {
            day: [
                '21/05/17',
                '22/05/17',
                '23/05/17',
                '24/05/17',
                '25/05/17',
                '26/05/17',
                '27/05/17',
                '28/05/17',
                '29/05/17',
                '30/05/17',
                '31/05/17',
                '01/06/17',
                '02/06/17',
                '03/06/17',
                '04/06/17',
                '05/06/17',
                '06/06/17',
                '07/06/17',
                '08/06/17',
                '09/06/17',
                '10/06/17',
                '11/06/17',
                '12/06/17',
                '13/06/17',
                '14/06/17',
                '15/06/17',
                '16/06/17',
                '17/06/17',
                '18/06/17',
                '19/06/17',
                '20/06/17',
                '21/06/17',
                '22/06/17',
                '23/06/17',
                '24/06/17',
                '25/06/17',
                '26/06/17',
                '27/06/17',
                '28/06/17',
                '29/06/17',
                '30/06/17',
                '01/07/17',
                '02/07/17',
                '03/07/17',
                '04/07/17',
                '05/07/17',
                '06/07/17',
                '07/07/17',
                '08/07/17',
                '09/07/17',
                '10/07/17',
                '11/07/17',
                '12/07/17',
                '13/07/17',
                '14/07/17',
                '15/07/17',
                '16/07/17',
                '17/07/17',
                '18/07/17',
                '19/07/17',
                '20/07/17',
                '21/07/17',
                '22/07/17',
                '23/07/17',
                '24/07/17',
                '25/07/17',
                '26/07/17',
                '27/07/17',
                '28/07/17',
                '29/07/17',
                '30/07/17',
                '31/07/17',
                '01/08/17',
                '02/08/17',
                '03/08/17',
                '04/08/17',
                '05/08/17',
                '06/08/17',
                '07/08/17',
                '08/08/17',
                '09/08/17',
                '10/08/17',
                '11/08/17',
                '12/08/17',
                '13/08/17',
                '14/08/17',
                '15/08/17',
                '16/08/17',
                '17/08/17',
                '18/08/17',
                '19/08/17',
                '20/08/17',
                '21/08/17',
                '22/08/17',
                '23/08/17',
                '24/08/17',
                '25/08/17',
                '26/08/17',
                '27/08/17',
                '28/08/17',
                '29/08/17',
                '30/08/17',
                '31/08/17',
                '01/09/17',
                '02/09/17',
                '03/09/17',
                '04/09/17',
                '05/09/17',
                '06/09/17',
                '07/09/17',
                '08/09/17',
                '09/09/17',
                '10/09/17',
                '11/09/17',
                '12/09/17',
                '13/09/17',
                '14/09/17',
                '15/09/17',
                '16/09/17',
                '17/09/17',
                '18/09/17',
                '19/09/17',
                '20/09/17',
                '21/09/17',
                '22/09/17',
                '23/09/17',
                '24/09/17',
                '25/09/17',
                '26/09/17',
                '27/09/17',
                '28/09/17',
                '29/09/17',
                '30/09/17',
                '01/10/17',
                '02/10/17',
                '03/10/17',
                '04/10/17',
                '05/10/17',
                '06/10/17',
                '07/10/17',
                '08/10/17',
                '09/10/17',
                '10/10/17',
                '11/10/17',
                '12/10/17',
                '13/10/17',
                '14/10/17',
                '15/10/17',
                '16/10/17',
                '17/10/17',
                '18/10/17',
                '19/10/17',
                '20/10/17',
                '21/10/17',
                '22/10/17',
                '23/10/17',
                '24/10/17',
                '25/10/17',
                '26/10/17',
                '27/10/17',
                '28/10/17',
                '29/10/17',
                '30/10/17',
                '31/10/17',
                '01/11/17',
                '02/11/17',
                '03/11/17',
                '04/11/17',
                '05/11/17',
                '06/11/17',
                '07/11/17',
                '08/11/17',
                '09/11/17',
                '10/11/17',
                '11/11/17',
                '12/11/17',
                '13/11/17',
                '14/11/17',
                '15/11/17',
                '16/11/17',
                '17/11/17',
                '18/11/17',
                '19/11/17',
                '20/11/17',
                '21/11/17',
                '22/11/17',
                '23/11/17',
                '24/11/17',
                '25/11/17',
                '26/11/17',
                '27/11/17',
                '28/11/17',
                '29/11/17',
                '30/11/17',
                '01/12/17',
                '02/12/17',
                '03/12/17',
                '04/12/17',
                '05/12/17',
                '06/12/17',
                '07/12/17',
                '08/12/17',
                '09/12/17',
                '10/12/17',
                '11/12/17',
                '12/12/17',
                '13/12/17',
                '14/12/17',
                '15/12/17',
                '16/12/17',
                '17/12/17',
                '18/12/17',
                '19/12/17',
                '20/12/17',
                '21/12/17',
                '22/12/17',
                '23/12/17',
                '24/12/17',
                '25/12/17',
                '26/12/17',
                '27/12/17',
                '28/12/17',
                '29/12/17',
                '30/12/17',
                '31/12/17',
                '01/01/19',
                '02/01/19',
                '03/01/19',
                '04/01/19',
                '05/01/19',
                '06/01/19',
                '07/01/19',
                '08/01/19',
                '09/01/19',
                '10/01/19',
                '11/01/19',
                '12/01/19',
                '13/01/19',
                '14/01/19',
                '15/01/19',
                '16/01/19',
                '17/01/19',
                '18/01/19',
                '19/01/19',
                '20/01/19',
                '21/01/19',
                '22/01/19',
                '23/01/19',
                '24/01/19',
                '25/01/19',
                '26/01/19',
                '27/01/19',
                '28/01/19',
                '29/01/19',
                '30/01/19',
                '31/01/19',
                '01/02/19',
                '02/02/19',
                '03/02/19',
                '04/02/19',
                '05/02/19',
                '06/02/19',
                '07/02/19',
                '08/02/19',
                '09/02/19',
                '10/02/19',
                '11/02/19',
                '12/02/19',
                '13/02/19',
                '14/02/19',
                '15/02/19',
                '16/02/19',
                '17/02/19',
                '18/02/19',
                '19/02/19',
                '20/02/19',
                '21/02/19',
                '22/02/19',
                '23/02/19',
                '24/02/19',
                '25/02/19',
                '26/02/19',
                '27/02/19',
                '28/02/19',
                '01/03/19',
                '02/03/19',
                '03/03/19',
                '04/03/19',
                '05/03/19',
                '06/03/19',
                '07/03/19',
                '08/03/19',
                '09/03/19',
                '10/03/19',
                '11/03/19',
                '12/03/19',
                '13/03/19',
                '14/03/19',
                '15/03/19',
                '16/03/19',
                '17/03/19',
                '18/03/19',
                '19/03/19',
                '20/03/19',
                '21/03/19',
                '22/03/19',
                '23/03/19',
                '24/03/19',
                '25/03/19',
                '26/03/19',
                '27/03/19',
                '28/03/19',
                '29/03/19',
                '30/03/19',
                '31/03/19',
                '01/04/19',
                '02/04/19',
                '03/04/19',
                '04/04/19',
                '05/04/19',
                '06/04/19',
                '07/04/19',
                '08/04/19',
                '09/04/19',
                '10/04/19',
                '11/04/19',
                '12/04/19',
                '13/04/19',
                '14/04/19',
                '15/04/19',
                '16/04/19',
                '17/04/19',
                '18/04/19',
                '19/04/19',
                '20/04/19',
                '21/04/19',
                '22/04/19',
                '23/04/19',
                '24/04/19',
                '25/04/19',
                '26/04/19',
                '27/04/19',
                '28/04/19',
                '29/04/19',
                '30/04/19',
                '01/05/19',
                '02/05/19',
                '03/05/19',
                '04/05/19',
                '05/05/19',
                '06/05/19',
                '07/05/19',
                '08/05/19',
                '09/05/19',
                '10/05/19',
                '11/05/19',
                '12/05/19',
                '13/05/19',
                '14/05/19',
                '15/05/19',
                '16/05/19',
                '17/05/19',
                '18/05/19',
                '19/05/19',
                '20/05/19',
                '21/05/19',
                '22/05/19',
                '23/05/19',
                '24/05/19',
                '25/05/19',
                '26/05/19',
                '27/05/19',
                '28/05/19',
                '29/05/19',
                '30/05/19',
                '31/05/19',
                '01/06/19',
                '02/06/19',
                '03/06/19',
                '04/06/19',
                '05/06/19',
                '06/06/19',
                '07/06/19',
                '08/06/19',
                '09/06/19',
                '10/06/19',
                '11/06/19',
                '12/06/19',
                '13/06/19'
            ],
            year: [ '2018' ]

        };

        getPeriods(dateFrom, dateTo, {restrictedGranularity: {quarter: true, month: true}, formats: { day: "DD/MM/YY" }}).should.be.eql(expectedData);
        done();
    });
});
